---
layout: post
title: Exploiting quotes() and open() functions perl
date: 2019-08-21
author: th3-3inst3in
comments: true
categories: overthewire
tags: [web,overthewire]
---

### Exploiting perl open() funtion
Reviewing scripts and finding flaws in them is an essential skill to have. First we will look at the `open()` function.

In perl `open()` function is used to handle files, it is most commonly used to read a file and diplay its output. Lets write a simple perl CLI script and read a file.

Create a file called test.txt.

Following is a simple code of how to use `open()` in perl copy the code below in to a file called test.pl.

```perl
#!/usr/bin/perl
use warnings;
use strict;
 
my $filename = $ARGV[0];
 
open(FH, '<', $filename) or die $!;
 
while(<FH>){
   print $_;
}
 
close(FH);

```

Turns out that the open() function is vulnerable to Command Execution and can be exploited just by using a simple single pipeline character in the following manner.

![Open Rce]({{ site.giturl }}/MyCtfWriteups/assets/images/overthewire/natas29/openrce.png)

If you want to try this out on a live site then try out the following CTF
#### Natas29 writeup

[http://natas29.natas.labs.overthewire.org/](http://natas29.natas.labs.overthewire.org/)

Once you login to the ctf with the credentials gained from previous challenge i.e natas28 you will see that perl is being used to read local files and we can enter the filename in the _GET_ parameter **?file=**.

![id command]({{ site.giturl }}/MyCtfWriteups/assets/images/overthewire/natas29/ctfid.png)

Now the flag is actually in the _/etc/natas_webpass_ directory but here is a twist there is a check in place that if we enter the keyword 'natas' in the url it will block the command from being run.

We can simply bypass that with an obfuscated shell command like the following

![id command]({{ site.giturl }}/MyCtfWriteups/assets/images/overthewire/natas29/ctfid.png)


* * *
* * *